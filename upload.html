<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="format-detection" content="telephone=no">
  <title>作品上传 - 桑梓</title>
  <meta name="description" content="桑梓个人创作平台 - 上传和管理您的文学、艺术、音乐、视频作品">
  <link rel="stylesheet" href="css/style.css?v=20240807">
  <link rel="stylesheet" href="css/ios-compatibility.css?v=20240810">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <style>
    /* 上传页面专用样式 - 与主页风格保持一致 */
    body {
      padding-top: 70px; /* 为固定导航栏留出空间 */
    }

    .upload-hero {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 80px 0;
      text-align: center;
      margin-bottom: 0;
    }

    .hero-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .hero-title {
      font-size: 3rem;
      margin-bottom: 1rem;
      font-weight: 700;
    }

    .hero-description {
      font-size: 1.2rem;
      margin-bottom: 2rem;
      opacity: 0.9;
    }

    .user-info {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 12px;
      margin: 30px auto;
      max-width: 1200px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      border-left: 4px solid #007bff;
    }

    .current-user {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #333;
    }

    .auth-required {
      text-align: center;
      padding: 60px 40px;
      background: rgba(255,255,255,0.95);
      border-radius: 12px;
      margin: 30px auto;
      max-width: 500px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .auth-required h3 {
      color: #333;
      margin-bottom: 15px;
    }

    .login-form {
      max-width: 300px;
      margin: 20px auto;
    }

    .login-form input {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
    }

    .upload-section {
      background: rgba(255,255,255,0.95);
      border-radius: 12px;
      padding: 40px;
      margin: 30px auto;
      max-width: 1200px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .section-title {
      font-size: 2rem;
      color: #333;
      text-align: center;
      margin-bottom: 30px;
    }

    .file-type-selector {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    .file-type-selector .btn {
      padding: 12px 24px;
      border: 2px solid #007bff;
      background: transparent;
      color: #007bff;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }

    .file-type-selector .btn.active,
    .file-type-selector .btn:hover {
      background: #007bff;
      color: white;
    }

    .drop-zone {
      border: 2px dashed #007bff;
      border-radius: 12px;
      padding: 60px 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #f8f9fa;
      margin: 30px 0;
    }

    .drop-zone:hover, .drop-zone.dragover {
      border-color: #0056b3;
      background: #e3f2fd;
      transform: translateY(-2px);
    }

    .drop-zone-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .drop-zone-icon {
      font-size: 48px;
      color: #007bff;
    }

    .drop-zone-text p {
      margin: 5px 0;
      font-size: 18px;
      color: #333;
    }

    .drop-zone-hint {
      font-size: 14px;
      color: #6c757d;
    }

    .upload-progress {
      margin: 20px 0;
      background: #e9ecef;
      border-radius: 10px;
      overflow: hidden;
      height: 25px;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #007bff, #0056b3);
      width: 0%;
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 14px;
      font-weight: 600;
    }

    .upload-info {
      background: #e7f3ff;
      padding: 25px;
      border-radius: 12px;
      margin: 30px 0;
    }

    .upload-info h4 {
      margin-top: 0;
      color: #0056b3;
      font-size: 1.2rem;
    }

    .upload-info ul {
      margin: 15px 0;
      padding-left: 25px;
    }

    .upload-info li {
      margin: 8px 0;
      color: #495057;
      line-height: 1.6;
    }

    .file-list-container {
      margin-top: 40px;
      padding-top: 40px;
      border-top: 2px solid #dee2e6;
    }

    .file-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 25px;
      margin-top: 25px;
    }

    .file-item {
      background: white;
      border: 1px solid #dee2e6;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
    }

    .file-item:hover {
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .file-icon {
      font-size: 28px;
      margin-bottom: 12px;
    }

    .file-name {
      font-weight: 600;
      margin-bottom: 8px;
      word-break: break-word;
      color: #333;
    }

    .file-meta {
      font-size: 0.9em;
      color: #6c757d;
      margin-bottom: 15px;
    }

    .file-meta span {
      margin-right: 15px;
    }

    .file-actions {
      display: flex;
      gap: 10px;
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 0.875em;
      border-radius: 6px;
    }

    .no-files {
      text-align: center;
      color: #6c757d;
      font-style: italic;
      padding: 60px;
      font-size: 1.1rem;
    }



    /* 存储徽章样式 */
    .storage-badge {
      font-size: 16px;
      padding: 4px 8px;
      border-radius: 4px;
      font-weight: bold;
      display: inline-block;
      min-width: 24px;
      text-align: center;
    }

    .storage-firebase {
      background-color: #e3f2fd;
      color: #1976d2;
      border: 1px solid #bbdefb;
    }

    .storage-local {
      background-color: #fff3e0;
      color: #f57c00;
      border: 1px solid #ffcc02;
    }

    .storage-preset {
      background-color: #f3e5f5;
      color: #7b1fa2;
      border: 1px solid #ce93d8;
    }

    /* 通知动画 */
    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes slideOutRight {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }

    /* 模态框样式 */
    .modal {
      position: fixed;
      z-index: 10002;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* UI组件层级定义 */
    /*
    层级规划：
    - 导航栏: 10000 (最高，始终在顶部)
    - 通知消息: 10001 (在导航栏之上)
    - 模态框: 10002 (在通知之上)
    - 其他浮动元素: 1000以下
    */

    .modal-content {
      background-color: white;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      position: relative;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    .close-btn {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      color: #aaa;
      transition: color 0.3s ease;
    }

    .close-btn:hover {
      color: #333;
    }

    .modal h3 {
      margin-top: 0;
      margin-bottom: 20px;
      color: #333;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
    }

    .form-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 25px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background-color: #007bff;
      color: white;
    }

    .btn-primary:hover {
      background-color: #0056b3;
    }

    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background-color: #545b62;
    }

    .btn-danger {
      background-color: #dc3545;
      color: white;
    }

    .btn-danger:hover {
      background-color: #c82333;
    }

    .form-control {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
    }

    .form-control:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
    }

    .form-control.error {
      border-color: #dc3545;
      box-shadow: 0 0 0 2px rgba(220,53,69,0.25);
    }

    .form-error {
      color: #dc3545;
      font-size: 14px;
      margin-top: 5px;
      display: block;
      min-height: 20px;
    }

    .form-success {
      color: #28a745;
      font-size: 14px;
      margin-top: 5px;
      display: block;
    }

    /* 新增表单样式 */
    .upload-form {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin: 20px 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border: 1px solid #e9ecef;
      display: none;
    }

    .upload-form.active {
      display: block;
    }

    .subcategory-fields {
      margin-top: 20px;
    }

    .required {
      color: #dc3545;
      font-weight: bold;
    }

    .file-upload-area {
      position: relative;
    }

    .file-upload-hint {
      font-size: 0.875rem;
      color: #6c757d;
      margin-top: 5px;
    }

    .form-actions {
      display: flex;
      gap: 15px;
      justify-content: flex-end;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e9ecef;
    }

    .form-actions .btn {
      min-width: 120px;
    }

    /* 文学作品子分类切换动画 */
    .subcategory-fields {
      transition: all 0.3s ease;
    }

    /* 页脚下拉菜单样式 */
    .works-dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-trigger {
      color: #ffffff;
      text-decoration: none;
      cursor: pointer;
      padding: 5px 10px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    .dropdown-trigger:hover {
      background-color: rgba(0, 123, 255, 0.1);
    }

    .dropdown-menu {
      position: absolute;
      bottom: 100%;
      left: 0;
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      min-width: 180px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .works-dropdown:hover .dropdown-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .dropdown-menu a {
      display: block;
      padding: 12px 16px;
      color: #333;
      text-decoration: none;
      border-bottom: 1px solid #f0f0f0;
      transition: background-color 0.3s ease;
    }

    .dropdown-menu a:last-child {
      border-bottom: none;
    }

    .dropdown-menu a:hover {
      background-color: #f8f9fa;
    }

    .dropdown-menu a.current-page {
      background-color: #007bff;
      color: white;
      font-weight: 500;
    }

    .dropdown-menu a.current-page:hover {
      background-color: #0056b3;
    }

    /* 文件上传区域样式优化 */
    .file-upload-area input[type="file"] {
      padding: 15px;
      border: 2px dashed #dee2e6;
      border-radius: 8px;
      background: #f8f9fa;
      transition: all 0.3s ease;
    }

    .file-upload-area input[type="file"]:hover {
      border-color: #007bff;
      background: #e3f2fd;
    }

    .file-upload-area input[type="file"]:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0,123,255,0.25);
    }

    /* 表单验证样式 */
    .form-control.is-invalid {
      border-color: #dc3545;
      box-shadow: 0 0 0 2px rgba(220,53,69,0.25);
    }

    .form-control.is-valid {
      border-color: #28a745;
      box-shadow: 0 0 0 2px rgba(40,167,69,0.25);
    }

    .invalid-feedback {
      display: block;
      width: 100%;
      margin-top: 5px;
      font-size: 0.875rem;
      color: #dc3545;
    }

    .valid-feedback {
      display: block;
      width: 100%;
      margin-top: 5px;
      font-size: 0.875rem;
      color: #28a745;
    }

    /* 权限设置样式 */
    .permission-preview {
      background: #e7f3ff;
      border: 1px solid #b3d9ff;
      border-radius: 6px;
      padding: 10px;
      margin-top: 10px;
      font-size: 0.9em;
    }

    .permission-preview h5 {
      margin: 0 0 8px 0;
      color: #0056b3;
      font-size: 1em;
    }

    .permission-preview ul {
      margin: 5px 0;
      padding-left: 20px;
    }

    .permission-preview li {
      margin: 3px 0;
    }

    .custom-permissions-container {
      border: 1px solid #dee2e6;
      border-radius: 6px;
      padding: 15px;
      margin-top: 10px;
      background: #f8f9fa;
    }

    .permission-radio-group {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }

    .permission-radio-group label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-weight: normal;
    }

    .permission-radio-group input[type="radio"] {
      margin: 0;
    }

    .github-status {
      padding: 10px;
      border-radius: 6px;
      margin-top: 10px;
    }

    .github-status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .github-status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .github-status.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    /* 响应式设计 */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 2rem;
      }

      .hero-description {
        font-size: 1rem;
      }

      .upload-section,
      .user-info {
        margin: 20px;
        padding: 20px;
      }

      .upload-form {
        padding: 20px;
        margin: 15px 0;
      }

      .file-type-selector {
        flex-direction: column;
        align-items: center;
      }

      .current-user {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }



      .modal-content {
        width: 95%;
        margin: 20px;
        padding: 20px;
      }

      .form-actions {
        flex-direction: column;
      }

      .form-actions .btn {
        min-width: auto;
        width: 100%;
      }

      /* 移动设备上的通知位置调整 */
      .notification {
        top: 70px !important;
        right: 10px !important;
        left: 10px !important;
        max-width: none !important;
        margin: 0 !important;
      }

      /* 移动设备上的表单错误提示 */
      .form-error {
        font-size: 12px;
      }

      /* 移动设备上的登录表单 */
      .login-form {
        padding: 0 10px;
      }
    }

    /* GitHub 配置提示样式 */
    .config-notice {
      background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
      border: 1px solid #2196f3;
      border-radius: 12px;
      padding: 0;
      overflow: hidden;
    }

    .notice-content {
      padding: 20px;
    }

    .config-notice h4 {
      color: #1976d2;
      margin-top: 0;
      margin-bottom: 15px;
      font-weight: 600;
    }

    .config-notice p {
      color: #424242;
      margin-bottom: 15px;
      line-height: 1.6;
    }

    .config-actions {
      margin: 20px 0;
    }

    .config-actions .btn {
      background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
      border: none;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      text-decoration: none;
      display: inline-block;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .config-actions .btn:hover {
      background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
    }

    .config-details {
      background: rgba(255, 255, 255, 0.7);
      padding: 10px 15px;
      border-radius: 6px;
      margin-top: 15px;
    }

    .config-details p {
      margin: 0;
      font-size: 13px;
      color: #666;
    }
  </style>
</head>
<body>
  <!-- 导航栏 -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <h2>桑梓</h2>
      </div>
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="index.html" class="nav-link">首页</a>
        </li>
        <li class="nav-item">
          <a href="index.html#about" class="nav-link">关于我</a>
        </li>

        <li class="nav-item">
          <a href="index.html#contact" class="nav-link">联系我</a>
        </li>

      </ul>
      <div class="nav-toggle" id="mobile-menu">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </div>
  </nav>

  <!-- 主标题区域 -->
  <header class="upload-hero">
    <div class="hero-container">
      <h1 class="hero-title">作品上传中心</h1>
      <p class="hero-description">分享您的创作，让文字与艺术在这里绽放</p>
    </div>
  </header>

  <!-- 主要内容区域 -->
  <main>
    <!-- 用户信息显示区域 -->
    <div id="userInfoContainer"></div>

    <!-- GitHub配置提示区域 -->
    <section class="upload-section" id="githubConfigSection" style="display: none;">
      <h2 class="section-title">⚙️ GitHub存储配置</h2>
      <div class="config-notice">
        <div class="notice-content">
          <h4>🔗 GitHub Token 配置</h4>
          <p>为了在 GitHub Pages 环境下正常保存和同步数据，需要配置 GitHub Personal Access Token。</p>
          <p><strong>请前往管理员控制面板进行配置：</strong></p>
          <div class="config-actions">
            <a href="admin.html" class="btn btn-primary">🔧 前往管理员面板配置</a>
          </div>
          <div class="config-details">
            <p><small>配置路径：管理员控制面板 → 系统设置 → GitHub 存储配置</small></p>
          </div>
        </div>
      </div>
    </section>

    <!-- 作品上传区域 -->
    <section class="upload-section">
      <h2 class="section-title">📤 作品上传</h2>

      <!-- 作品类型选择器 -->
      <div class="file-type-selector">
        <button class="btn active" data-type="literature">📚 文学作品</button>
        <button class="btn" data-type="art">🎨 绘画作品</button>
        <button class="btn" data-type="music">🎵 音乐作品</button>
        <button class="btn" data-type="video">🎬 视频作品</button>
      </div>

      <!-- 文学作品上传表单 -->
      <div id="literatureForm" class="upload-form active">
        <!-- 子分类选择 -->
        <div class="form-group">
          <label>文学作品类型</label>
          <select id="literatureSubcategory" class="form-control">
            <option value="essay">生活随笔</option>
            <option value="poetry">诗歌创作</option>
            <option value="novel">小说连载</option>
          </select>
        </div>

        <!-- 生活随笔表单 -->
        <div id="essayFields" class="subcategory-fields">
          <div class="form-group">
            <label>随笔题目 <span class="required">*</span></label>
            <input type="text" id="essayTitle" class="form-control" placeholder="请输入随笔题目" required>
          </div>
          <div class="form-group">
            <label>随笔内容 <span class="required">*</span></label>
            <textarea id="essayContent" class="form-control" rows="10" placeholder="请输入随笔内容，支持Markdown格式" required></textarea>
          </div>
        </div>

        <!-- 诗歌创作表单 -->
        <div id="poetryFields" class="subcategory-fields" style="display: none;">
          <div class="form-group">
            <label>诗歌题目 <span class="required">*</span></label>
            <input type="text" id="poetryTitle" class="form-control" placeholder="请输入诗歌题目" required>
          </div>
          <div class="form-group">
            <label>诗歌类型</label>
            <select id="poetryType" class="form-control">
              <option value="modern">现代诗</option>
              <option value="classical">古体诗词</option>
            </select>
          </div>
          <div class="form-group">
            <label>诗歌内容 <span class="required">*</span></label>
            <textarea id="poetryContent" class="form-control" rows="8" placeholder="请输入诗歌内容" required></textarea>
          </div>
        </div>

        <!-- 小说连载表单 -->
        <div id="novelFields" class="subcategory-fields" style="display: none;">
          <div class="form-group">
            <label>小说题目 <span class="required">*</span></label>
            <input type="text" id="novelTitle" class="form-control" placeholder="请输入小说题目" required>
          </div>
          <div class="form-group">
            <label>章节号 <span class="required">*</span></label>
            <input type="number" id="novelChapter" class="form-control" placeholder="请输入章节号" min="1" required>
          </div>
          <div class="form-group">
            <label>节标题</label>
            <input type="text" id="novelChapterTitle" class="form-control" placeholder="请输入节标题（可选）">
          </div>
          <div class="form-group">
            <label>章节内容 <span class="required">*</span></label>
            <textarea id="novelContent" class="form-control" rows="12" placeholder="请输入章节内容" required></textarea>
          </div>
        </div>

        <!-- 通用设置 -->
        <div class="form-group">
          <label>访问权限</label>
          <select id="literaturePermission" class="form-control" onchange="togglePermissionSettings('literature')">
            <option value="public">🌍 公开（所有人可见）</option>
            <option value="friend">👥 仅好友可见</option>
            <option value="visitor">👤 访客及以上可见</option>
            <option value="custom">⚙️ 自定义权限</option>
            <option value="private">🔒 私有（仅自己可见）</option>
          </select>
        </div>

        <!-- 自定义权限设置 -->
        <div id="literatureCustomPermissions" class="form-group" style="display: none;">
          <label>自定义权限设置</label>
          <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
            <div class="form-group">
              <label>
                <input type="radio" name="literaturePermissionType" value="whitelist" checked>
                白名单模式（仅指定用户可见）
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="radio" name="literaturePermissionType" value="blacklist">
                黑名单模式（指定用户不可见）
              </label>
            </div>
            <div class="form-group">
              <label>指定用户（用逗号分隔）</label>
              <input type="text" id="literatureUserList" class="form-control" placeholder="例如：user1, user2, user3">
            </div>
          </div>
          <div class="permission-preview" id="literaturePermissionPreview"></div>
        </div>

        <div class="form-actions">
          <button type="button" id="submitLiterature" class="btn btn-primary">发布作品</button>
          <button type="button" id="resetLiterature" class="btn btn-secondary">重置表单</button>
        </div>
      </div>

      <!-- 绘画作品上传表单 -->
      <div id="artForm" class="upload-form" style="display: none;">
        <div class="form-group">
          <label>绘画作品类型</label>
          <select id="artSubcategory" class="form-control">
            <option value="painting">绘画作品</option>
            <option value="sketch">素描作品</option>
            <option value="digital">数字艺术</option>
          </select>
        </div>
        <div class="form-group">
          <label>作品题目 <span class="required">*</span></label>
          <input type="text" id="artTitle" class="form-control" placeholder="请输入作品题目" required>
        </div>
        <div class="form-group">
          <label>作品图片 <span class="required">*</span></label>
          <div class="file-upload-area">
            <input type="file" id="artFile" class="form-control" accept="image/*" required>
            <div class="file-upload-hint">支持 JPG、PNG、GIF、WebP 格式，最大 10MB</div>
          </div>
        </div>
        <div class="form-group">
          <label>作品简介</label>
          <textarea id="artDescription" class="form-control" rows="4" placeholder="请简单介绍一下这幅作品"></textarea>
        </div>
        <div class="form-group">
          <label>访问权限</label>
          <select id="artPermission" class="form-control" onchange="togglePermissionSettings('art')">
            <option value="public">🌍 公开（所有人可见）</option>
            <option value="friend">👥 仅好友可见</option>
            <option value="visitor">👤 访客及以上可见</option>
            <option value="custom">⚙️ 自定义权限</option>
            <option value="private">🔒 私有（仅自己可见）</option>
          </select>
        </div>

        <!-- 自定义权限设置 -->
        <div id="artCustomPermissions" class="form-group" style="display: none;">
          <label>自定义权限设置</label>
          <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
            <div class="form-group">
              <label>
                <input type="radio" name="artPermissionType" value="whitelist" checked>
                白名单模式（仅指定用户可见）
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="radio" name="artPermissionType" value="blacklist">
                黑名单模式（指定用户不可见）
              </label>
            </div>
            <div class="form-group">
              <label>指定用户（用逗号分隔）</label>
              <input type="text" id="artUserList" class="form-control" placeholder="例如：user1, user2, user3">
            </div>
          </div>
          <div class="permission-preview" id="artPermissionPreview"></div>
        </div>
        <div class="form-actions">
          <button type="button" id="submitArt" class="btn btn-primary">发布作品</button>
          <button type="button" id="resetArt" class="btn btn-secondary">重置表单</button>
        </div>
      </div>

      <!-- 音乐作品上传表单 -->
      <div id="musicForm" class="upload-form" style="display: none;">
        <div class="form-group">
          <label>音乐作品类型</label>
          <select id="musicSubcategory" class="form-control">
            <option value="original">原创音乐</option>
            <option value="cover">翻唱作品</option>
            <option value="instrumental">器乐演奏</option>
          </select>
        </div>
        <div class="form-group">
          <label>作品题目 <span class="required">*</span></label>
          <input type="text" id="musicTitle" class="form-control" placeholder="请输入作品题目" required>
        </div>
        <div class="form-group">
          <label>音频文件 <span class="required">*</span></label>
          <div class="file-upload-area">
            <input type="file" id="musicFile" class="form-control" accept="audio/*" required>
            <div class="file-upload-hint">支持 MP3、WAV、FLAC、M4A、AAC 格式，最大 10MB</div>
          </div>
        </div>
        <div class="form-group">
          <label>作品简介 <span class="required">*</span></label>
          <textarea id="musicDescription" class="form-control" rows="4" placeholder="请介绍一下这首音乐作品" required></textarea>
        </div>
        <div class="form-group">
          <label>访问权限</label>
          <select id="musicPermission" class="form-control" onchange="togglePermissionSettings('music')">
            <option value="public">🌍 公开（所有人可见）</option>
            <option value="friend">👥 仅好友可见</option>
            <option value="visitor">👤 访客及以上可见</option>
            <option value="custom">⚙️ 自定义权限</option>
            <option value="private">🔒 私有（仅自己可见）</option>
          </select>
        </div>

        <!-- 自定义权限设置 -->
        <div id="musicCustomPermissions" class="form-group" style="display: none;">
          <label>自定义权限设置</label>
          <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
            <div class="form-group">
              <label>
                <input type="radio" name="musicPermissionType" value="whitelist" checked>
                白名单模式（仅指定用户可见）
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="radio" name="musicPermissionType" value="blacklist">
                黑名单模式（指定用户不可见）
              </label>
            </div>
            <div class="form-group">
              <label>指定用户（用逗号分隔）</label>
              <input type="text" id="musicUserList" class="form-control" placeholder="例如：user1, user2, user3">
            </div>
          </div>
          <div class="permission-preview" id="musicPermissionPreview"></div>
        </div>
        <div class="form-actions">
          <button type="button" id="submitMusic" class="btn btn-primary">发布作品</button>
          <button type="button" id="resetMusic" class="btn btn-secondary">重置表单</button>
        </div>
      </div>

      <!-- 视频作品上传表单 -->
      <div id="videoForm" class="upload-form" style="display: none;">
        <div class="form-group">
          <label>视频作品类型</label>
          <select id="videoSubcategory" class="form-control">
            <option value="short">创意短片</option>
            <option value="documentary">纪录片</option>
            <option value="travel">旅行影像</option>
          </select>
        </div>
        <div class="form-group">
          <label>作品题目 <span class="required">*</span></label>
          <input type="text" id="videoTitle" class="form-control" placeholder="请输入作品题目" required>
        </div>
        <div class="form-group">
          <label>视频文件 <span class="required">*</span></label>
          <div class="file-upload-area">
            <input type="file" id="videoFile" class="form-control" accept="video/*" required>
            <div class="file-upload-hint">支持 MP4、AVI、MOV、WMV、MKV 格式，最大 10MB</div>
          </div>
        </div>
        <div class="form-group">
          <label>作品简介 <span class="required">*</span></label>
          <textarea id="videoDescription" class="form-control" rows="4" placeholder="请介绍一下这个视频作品" required></textarea>
        </div>
        <div class="form-group">
          <label>访问权限</label>
          <select id="videoPermission" class="form-control" onchange="togglePermissionSettings('video')">
            <option value="public">🌍 公开（所有人可见）</option>
            <option value="friend">👥 仅好友可见</option>
            <option value="visitor">👤 访客及以上可见</option>
            <option value="custom">⚙️ 自定义权限</option>
            <option value="private">🔒 私有（仅自己可见）</option>
          </select>
        </div>

        <!-- 自定义权限设置 -->
        <div id="videoCustomPermissions" class="form-group" style="display: none;">
          <label>自定义权限设置</label>
          <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
            <div class="form-group">
              <label>
                <input type="radio" name="videoPermissionType" value="whitelist" checked>
                白名单模式（仅指定用户可见）
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="radio" name="videoPermissionType" value="blacklist">
                黑名单模式（指定用户不可见）
              </label>
            </div>
            <div class="form-group">
              <label>指定用户（用逗号分隔）</label>
              <input type="text" id="videoUserList" class="form-control" placeholder="例如：user1, user2, user3">
            </div>
          </div>
          <div class="permission-preview" id="videoPermissionPreview"></div>
        </div>
        <div class="form-actions">
          <button type="button" id="submitVideo" class="btn btn-primary">发布作品</button>
          <button type="button" id="resetVideo" class="btn btn-secondary">重置表单</button>
        </div>
      </div>

      <!-- 上传说明 -->
      <div class="upload-info">
        <h4>📋 上传说明</h4>
        <ul>
          <li><strong>文学作品：</strong>支持表单输入，内容支持Markdown格式</li>
          <li><strong>媒体作品：</strong>需要上传对应的文件，文件大小限制10MB</li>
          <li><strong>数据安全：</strong>作品按用户分类存储，确保数据隔离</li>
          <li><strong>权限控制：</strong>您可以设置作品的访问权限</li>
          <li><strong>分类展示：</strong>上传的作品将在主页对应分类中展示</li>
        </ul>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <p>&copy; 2024 桑梓. 个人文学创作分享平台.</p>
        <div class="footer-links">
          <a href="index.html" class="home-button">首页</a>
          <div class="works-dropdown">
            <span class="dropdown-trigger">作品展示 ▼</span>
            <div class="dropdown-menu">
              <a href="essays.html">生活随笔</a>
              <a href="poetry.html">诗歌创作</a>
              <a href="novels.html">小说连载</a>
              <a href="artworks.html">绘画作品</a>
              <a href="music.html">音乐作品</a>
              <a href="videos.html">视频作品</a>
            </div>
          </div>
          <a href="upload.html">上传作品</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- 返回顶部按钮 -->
  <button id="backToTop" class="back-to-top" onclick="scrollToTop()">↑</button>



  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

  <!-- iOS兼容性修复 - 必须在其他脚本之前加载 -->
  <script src="js/ios-compatibility.js"></script>

  <!-- 应用脚本 -->
  <script src="js/github-storage.js"></script>
  <script src="js/data-manager.js"></script>
  <script src="js/script.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/user-status.js"></script>
  <script src="js/unified-button-styles.js"></script>

  <script src="js/upload.js"></script>

  <script>
    // 页面专用JavaScript





    // 返回顶部功能
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // 显示返回顶部按钮
    window.addEventListener('scroll', () => {
      const backToTop = document.getElementById('backToTop');
      if (window.pageYOffset > 300) {
        backToTop.style.display = 'block';
      } else {
        backToTop.style.display = 'none';
      }
    });



    // 显示通知消息函数
    function showNotification(message, type = 'info') {
      // 创建通知元素
      const notification = document.createElement('div');
      notification.className = `notification notification-${type}`;
      notification.textContent = message;

      // 添加样式
      notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        padding: 15px 20px;
        border-radius: 5px;
        color: white;
        font-weight: bold;
        z-index: 10001;
        max-width: 300px;
        word-wrap: break-word;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        animation: slideInRight 0.3s ease-out;
      `;

      // 根据类型设置背景色
      const colors = {
        success: '#4CAF50',
        error: '#f44336',
        warning: '#ff9800',
        info: '#2196F3'
      };
      notification.style.backgroundColor = colors[type] || colors.info;

      // 添加到页面
      document.body.appendChild(notification);

      // 3秒后自动移除
      setTimeout(() => {
        if (notification.parentNode) {
          notification.style.animation = 'slideOutRight 0.3s ease-in';
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 300);
        }
      }, 3000);
    }
    // 权限设置功能
    function togglePermissionSettings(category) {
      const permissionSelect = document.getElementById(`${category}Permission`);
      const customPermissions = document.getElementById(`${category}CustomPermissions`);

      if (permissionSelect.value === 'custom') {
        customPermissions.style.display = 'block';
        updatePermissionPreview(category);
      } else {
        customPermissions.style.display = 'none';
        updatePermissionPreview(category);
      }
    }

    function updatePermissionPreview(category) {
      const permissionSelect = document.getElementById(`${category}Permission`);
      const preview = document.getElementById(`${category}PermissionPreview`);
      const userList = document.getElementById(`${category}UserList`);
      const permissionType = document.querySelector(`input[name="${category}PermissionType"]:checked`);

      if (!preview) return;

      let previewText = '';
      const selectedValue = permissionSelect.value;

      switch (selectedValue) {
        case 'public':
          previewText = '<h5>🌍 公开权限</h5><p>所有访问者都可以查看此作品</p>';
          break;
        case 'friend':
          previewText = '<h5>👥 好友权限</h5><p>只有好友级别及以上用户可以查看</p>';
          break;
        case 'visitor':
          previewText = '<h5>👤 访客权限</h5><p>访客级别及以上用户可以查看</p>';
          break;
        case 'private':
          previewText = '<h5>🔒 私有权限</h5><p>只有您自己可以查看此作品</p>';
          break;
        case 'custom':
          if (permissionType && userList) {
            const users = userList.value.split(',').map(u => u.trim()).filter(u => u);
            const mode = permissionType.value;

            if (mode === 'whitelist') {
              previewText = '<h5>⚙️ 白名单模式</h5>';
              if (users.length > 0) {
                previewText += '<p>只有以下用户可以查看：</p><ul>';
                users.forEach(user => {
                  previewText += `<li>${user}</li>`;
                });
                previewText += '</ul>';
              } else {
                previewText += '<p>请指定允许查看的用户</p>';
              }
            } else {
              previewText = '<h5>⚙️ 黑名单模式</h5>';
              if (users.length > 0) {
                previewText += '<p>除以下用户外，好友级别用户都可以查看：</p><ul>';
                users.forEach(user => {
                  previewText += `<li>${user}</li>`;
                });
                previewText += '</ul>';
              } else {
                previewText += '<p>所有好友级别用户都可以查看</p>';
              }
            }
          }
          break;
      }

      preview.innerHTML = previewText;
    }

    // GitHub配置状态检查
    function checkGitHubConfig() {
      const savedToken = localStorage.getItem('github_token');
      const configSection = document.getElementById('githubConfigSection');

      if (configSection) {
        if (!savedToken) {
          // 如果没有配置 Token，显示配置提示
          configSection.style.display = 'block';
        } else {
          // 如果已配置 Token，隐藏配置提示
          configSection.style.display = 'none';
        }
      }
    }

    // 页面加载完成后初始化权限设置
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        checkGitHubConfig();

        // 为所有权限设置添加事件监听
        ['literature', 'art', 'music', 'video'].forEach(category => {
          const userList = document.getElementById(`${category}UserList`);
          const permissionRadios = document.querySelectorAll(`input[name="${category}PermissionType"]`);

          if (userList) {
            userList.addEventListener('input', () => updatePermissionPreview(category));
          }

          permissionRadios.forEach(radio => {
            radio.addEventListener('change', () => updatePermissionPreview(category));
          });
        });

        // 检查GitHub配置状态（所有用户都可以看到配置提示）
        checkGitHubConfig();
      }, 1000);
    });






  </script>
</body>
</html>