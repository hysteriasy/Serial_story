<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    <title>脚本加载测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>脚本加载测试</h1>
    <div id="test-results"></div>

    <!-- 加载所有脚本 -->
    <script src="js/script.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/user-status.js"></script>
    <script src="js/system-stats.js"></script>
    <script src="js/login-records-manager.js"></script>
    <script src="js/file-permissions-system.js"></script>
    <script src="js/file-permissions-ui.js"></script>
    <script src="js/batch-permissions-manager.js"></script>
    <script src="js/file-details-viewer.js"></script>
    <script src="js/unified-button-styles.js"></script>
    <script src="js/homepage-integration.js"></script>

    <script>
        // 测试脚本加载
        function testScriptLoading() {
            const results = document.getElementById('test-results');
            const tests = [
                { name: 'auth对象', test: () => typeof auth !== 'undefined' },
                { name: 'systemStatsManager对象', test: () => typeof window.systemStatsManager !== 'undefined' },
                { name: 'loginRecordsManager对象', test: () => typeof window.loginRecordsManager !== 'undefined' },
                { name: 'filePermissionsSystem对象', test: () => typeof window.filePermissionsSystem !== 'undefined' },
                { name: 'showSuccessMessage函数', test: () => typeof showSuccessMessage === 'function' },
                { name: 'showErrorMessage函数', test: () => typeof showErrorMessage === 'function' }
            ];

            tests.forEach(test => {
                const div = document.createElement('div');
                div.className = 'test-item';
                
                try {
                    const result = test.test();
                    if (result) {
                        div.className += ' success';
                        div.textContent = `✅ ${test.name}: 加载成功`;
                    } else {
                        div.className += ' error';
                        div.textContent = `❌ ${test.name}: 未找到`;
                    }
                } catch (error) {
                    div.className += ' error';
                    div.textContent = `❌ ${test.name}: 错误 - ${error.message}`;
                }
                
                results.appendChild(div);
            });

            // 测试背景图片
            const imgTest = document.createElement('div');
            imgTest.className = 'test-item';
            const img = new Image();
            img.onload = function() {
                imgTest.className += ' success';
                imgTest.textContent = '✅ 背景图片: 加载成功';
            };
            img.onerror = function() {
                imgTest.className += ' error';
                imgTest.textContent = '❌ 背景图片: 加载失败';
            };
            img.src = 'images/cec38ab95d65588029620c44d93ac499.jpg';
            results.appendChild(imgTest);
        }

        // 页面加载完成后执行测试
        window.addEventListener('load', testScriptLoading);
    </script>
</body>
</html>
