<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    <title>iOSå…¼å®¹æ€§æµ‹è¯• - æ¡‘æ¢“</title>
    <meta name="description" content="iOS Safariå…¼å®¹æ€§æµ‹è¯•é¡µé¢">
    <link rel="stylesheet" href="css/style.css?v=20240807">
    <link rel="stylesheet" href="css/ios-compatibility.css?v=20240810">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-top: 100px;
        }
        
        .test-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .test-title {
            color: #007bff;
            margin-bottom: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .test-item {
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .test-result {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .test-pass {
            background: #d4edda;
            color: #155724;
        }
        
        .test-fail {
            background: #f8d7da;
            color: #721c24;
        }
        
        .test-button {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 0.5rem;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
        }
        
        .backdrop-test {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        
        .animation-test {
            width: 50px;
            height: 50px;
            background: #007bff;
            border-radius: 50%;
            animation: bounce 2s infinite;
            margin: 1rem auto;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @-webkit-keyframes bounce {
            0%, 100% { -webkit-transform: translateY(0); }
            50% { -webkit-transform: translateY(-20px); }
        }
        
        .touch-test {
            background: #28a745;
            color: white;
            padding: 2rem;
            text-align: center;
            border-radius: 8px;
            margin: 1rem 0;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .font-test {
            font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .scroll-test {
            height: 200px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            border: 1px solid #ddd;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>æ¡‘æ¢“ - iOSæµ‹è¯•</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">è¿”å›é¦–é¡µ</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="test-container">
        <h1 style="text-align: center; color: #007bff; margin-bottom: 2rem;">iOS Safari å…¼å®¹æ€§æµ‹è¯•</h1>
        
        <!-- è®¾å¤‡ä¿¡æ¯æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">ğŸ“± è®¾å¤‡ä¿¡æ¯æ£€æµ‹</h2>
            <div class="test-item">
                <strong>ç”¨æˆ·ä»£ç†:</strong> <span id="userAgent"></span>
            </div>
            <div class="test-item">
                <strong>å±å¹•å°ºå¯¸:</strong> <span id="screenSize"></span>
            </div>
            <div class="test-item">
                <strong>è§†å£å°ºå¯¸:</strong> <span id="viewportSize"></span>
            </div>
            <div class="test-item">
                <strong>è®¾å¤‡åƒç´ æ¯”:</strong> <span id="devicePixelRatio"></span>
            </div>
            <div class="test-item">
                <strong>iOSè®¾å¤‡:</strong> <span id="isIOSDevice" class="test-result"></span>
            </div>
        </div>

        <!-- CSSç‰¹æ€§æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">ğŸ¨ CSSç‰¹æ€§æ”¯æŒæµ‹è¯•</h2>
            <div class="test-item">
                <strong>backdrop-filteræ”¯æŒ:</strong> <span id="backdropFilterSupport" class="test-result"></span>
            </div>
            <div class="test-item">
                <strong>CSS Gridæ”¯æŒ:</strong> <span id="cssGridSupport" class="test-result"></span>
            </div>
            <div class="test-item">
                <strong>Flexboxæ”¯æŒ:</strong> <span id="flexboxSupport" class="test-result"></span>
            </div>
            <div class="backdrop-test">
                <strong>backdrop-filteræ•ˆæœæµ‹è¯•</strong><br>
                å¦‚æœæ‚¨çœ‹åˆ°æ¨¡ç³ŠèƒŒæ™¯æ•ˆæœï¼Œè¯´æ˜backdrop-filterå·¥ä½œæ­£å¸¸
            </div>
        </div>

        <!-- åŠ¨ç”»æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">ğŸ¬ åŠ¨ç”»æ€§èƒ½æµ‹è¯•</h2>
            <div class="animation-test"></div>
            <p style="text-align: center;">å¦‚æœä¸Šæ–¹åœ†çƒæ­£åœ¨å¼¹è·³ï¼Œè¯´æ˜CSSåŠ¨ç”»å·¥ä½œæ­£å¸¸</p>
        </div>

        <!-- è§¦æ‘¸äº‹ä»¶æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">ğŸ‘† è§¦æ‘¸äº‹ä»¶æµ‹è¯•</h2>
            <div class="touch-test" id="touchTest">
                ç‚¹å‡»æˆ–è§¦æ‘¸è¿™é‡Œæµ‹è¯•è§¦æ‘¸äº‹ä»¶
            </div>
            <div class="test-item">
                <strong>è§¦æ‘¸äº‹ä»¶çŠ¶æ€:</strong> <span id="touchStatus">ç­‰å¾…æµ‹è¯•</span>
            </div>
        </div>

        <!-- å­—ä½“æ¸²æŸ“æµ‹è¯• */
        <div class="test-section">
            <h2 class="test-title">ğŸ”¤ å­—ä½“æ¸²æŸ“æµ‹è¯•</h2>
            <div class="font-test">
                <p>è¿™æ˜¯ä¸­æ–‡å­—ä½“æ¸²æŸ“æµ‹è¯•ï¼šæ¡‘æ¢“ä¸ªäººåˆ†äº«å¹³å°</p>
                <p>This is English font rendering test: Sangzi Personal Sharing Platform</p>
                <p>æ•°å­—æµ‹è¯•ï¼š1234567890</p>
                <p>ç‰¹æ®Šå­—ç¬¦ï¼šï¼@#ï¿¥%â€¦â€¦&*ï¼ˆï¼‰</p>
            </div>
        </div>

        <!-- æ»šåŠ¨æ€§èƒ½æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">ğŸ“œ æ»šåŠ¨æ€§èƒ½æµ‹è¯•</h2>
            <div class="scroll-test">
                <p>è¿™æ˜¯ä¸€ä¸ªæ»šåŠ¨æµ‹è¯•åŒºåŸŸã€‚åœ¨iOSè®¾å¤‡ä¸Šï¼Œæ»šåŠ¨åº”è¯¥æµç•…ä¸”æœ‰æƒ¯æ€§ã€‚</p>
                <p>ç¬¬1è¡Œå†…å®¹</p><p>ç¬¬2è¡Œå†…å®¹</p><p>ç¬¬3è¡Œå†…å®¹</p><p>ç¬¬4è¡Œå†…å®¹</p><p>ç¬¬5è¡Œå†…å®¹</p>
                <p>ç¬¬6è¡Œå†…å®¹</p><p>ç¬¬7è¡Œå†…å®¹</p><p>ç¬¬8è¡Œå†…å®¹</p><p>ç¬¬9è¡Œå†…å®¹</p><p>ç¬¬10è¡Œå†…å®¹</p>
                <p>ç¬¬11è¡Œå†…å®¹</p><p>ç¬¬12è¡Œå†…å®¹</p><p>ç¬¬13è¡Œå†…å®¹</p><p>ç¬¬14è¡Œå†…å®¹</p><p>ç¬¬15è¡Œå†…å®¹</p>
                <p>ç¬¬16è¡Œå†…å®¹</p><p>ç¬¬17è¡Œå†…å®¹</p><p>ç¬¬18è¡Œå†…å®¹</p><p>ç¬¬19è¡Œå†…å®¹</p><p>ç¬¬20è¡Œå†…å®¹</p>
            </div>
        </div>

        <!-- äº¤äº’æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">ğŸ¯ äº¤äº’åŠŸèƒ½æµ‹è¯•</h2>
            <button class="test-button" onclick="testAlert()">æµ‹è¯•å¼¹çª—</button>
            <button class="test-button" onclick="testVibration()">æµ‹è¯•éœ‡åŠ¨</button>
            <button class="test-button" onclick="testOrientation()">æµ‹è¯•æ–¹å‘</button>
            <div class="test-item">
                <strong>æµ‹è¯•ç»“æœ:</strong> <span id="interactionResult">ç­‰å¾…æµ‹è¯•</span>
            </div>
        </div>

        <!-- æ€§èƒ½æµ‹è¯• */
        <div class="test-section">
            <h2 class="test-title">âš¡ æ€§èƒ½æµ‹è¯•</h2>
            <button class="test-button" onclick="runPerformanceTest()">è¿è¡Œæ€§èƒ½æµ‹è¯•</button>
            <div class="test-item">
                <strong>é¡µé¢åŠ è½½æ—¶é—´:</strong> <span id="loadTime"></span>
            </div>
            <div class="test-item">
                <strong>DOMèŠ‚ç‚¹æ•°é‡:</strong> <span id="domNodes"></span>
            </div>
            <div class="test-item">
                <strong>å†…å­˜ä½¿ç”¨:</strong> <span id="memoryUsage"></span>
            </div>
        </div>
    </div>

    <!-- iOSå…¼å®¹æ€§ä¿®å¤ -->
    <script src="js/ios-compatibility.js"></script>
    
    <script>
        // é¡µé¢åŠ è½½æ—¶é—´è®°å½•
        const loadStartTime = performance.now();
        
        document.addEventListener('DOMContentLoaded', function() {
            runCompatibilityTests();
            
            // è®°å½•åŠ è½½æ—¶é—´
            const loadTime = performance.now() - loadStartTime;
            document.getElementById('loadTime').textContent = loadTime.toFixed(2) + 'ms';
        });

        function runCompatibilityTests() {
            // è®¾å¤‡ä¿¡æ¯æ£€æµ‹
            document.getElementById('userAgent').textContent = navigator.userAgent;
            document.getElementById('screenSize').textContent = screen.width + 'x' + screen.height;
            document.getElementById('viewportSize').textContent = window.innerWidth + 'x' + window.innerHeight;
            document.getElementById('devicePixelRatio').textContent = window.devicePixelRatio || 1;
            
            // iOSè®¾å¤‡æ£€æµ‹
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                         (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
            const iosElement = document.getElementById('isIOSDevice');
            iosElement.textContent = isIOS ? 'æ˜¯' : 'å¦';
            iosElement.className = 'test-result ' + (isIOS ? 'test-pass' : 'test-fail');

            // CSSç‰¹æ€§æ”¯æŒæ£€æµ‹
            testCSSSupport('backdrop-filter', 'blur(10px)', 'backdropFilterSupport');
            testCSSSupport('display', 'grid', 'cssGridSupport');
            testCSSSupport('display', 'flex', 'flexboxSupport');

            // è§¦æ‘¸äº‹ä»¶æµ‹è¯•
            setupTouchTest();
            
            // DOMèŠ‚ç‚¹æ•°é‡
            document.getElementById('domNodes').textContent = document.querySelectorAll('*').length;
        }

        function testCSSSupport(property, value, elementId) {
            const isSupported = CSS.supports(property, value) || CSS.supports('-webkit-' + property, value);
            const element = document.getElementById(elementId);
            element.textContent = isSupported ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ';
            element.className = 'test-result ' + (isSupported ? 'test-pass' : 'test-fail');
        }

        function setupTouchTest() {
            const touchTest = document.getElementById('touchTest');
            const touchStatus = document.getElementById('touchStatus');
            
            touchTest.addEventListener('touchstart', function() {
                touchStatus.textContent = 'è§¦æ‘¸å¼€å§‹';
            }, { passive: true });
            
            touchTest.addEventListener('touchend', function() {
                touchStatus.textContent = 'è§¦æ‘¸ç»“æŸ - è§¦æ‘¸äº‹ä»¶æ­£å¸¸';
            }, { passive: true });
            
            touchTest.addEventListener('click', function() {
                if (touchStatus.textContent === 'ç­‰å¾…æµ‹è¯•') {
                    touchStatus.textContent = 'ç‚¹å‡»äº‹ä»¶æ­£å¸¸';
                }
            });
        }

        function testAlert() {
            alert('å¼¹çª—æµ‹è¯•æˆåŠŸï¼');
            document.getElementById('interactionResult').textContent = 'å¼¹çª—æµ‹è¯•é€šè¿‡';
        }

        function testVibration() {
            if (navigator.vibrate) {
                navigator.vibrate(200);
                document.getElementById('interactionResult').textContent = 'éœ‡åŠ¨æµ‹è¯•é€šè¿‡';
            } else {
                document.getElementById('interactionResult').textContent = 'è®¾å¤‡ä¸æ”¯æŒéœ‡åŠ¨';
            }
        }

        function testOrientation() {
            const orientation = screen.orientation || screen.mozOrientation || screen.msOrientation;
            document.getElementById('interactionResult').textContent = 'å½“å‰æ–¹å‘: ' + (orientation ? orientation.type : window.orientation);
        }

        function runPerformanceTest() {
            // å†…å­˜ä½¿ç”¨æ£€æµ‹
            if (performance.memory) {
                const memory = performance.memory;
                const memoryInfo = `å·²ç”¨: ${(memory.usedJSHeapSize / 1024 / 1024).toFixed(2)}MB / æ€»è®¡: ${(memory.totalJSHeapSize / 1024 / 1024).toFixed(2)}MB`;
                document.getElementById('memoryUsage').textContent = memoryInfo;
            } else {
                document.getElementById('memoryUsage').textContent = 'æµè§ˆå™¨ä¸æ”¯æŒå†…å­˜æ£€æµ‹';
            }
        }

        // ç›‘å¬æ–¹å‘å˜åŒ–
        window.addEventListener('orientationchange', function() {
            setTimeout(function() {
                document.getElementById('viewportSize').textContent = window.innerWidth + 'x' + window.innerHeight;
            }, 100);
        });
    </script>
</body>
</html>
