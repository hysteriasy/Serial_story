---
type: "always_apply"
---

第一条，请注意：这个项目专门设计用于在 GitHub Pages 静态托管环境中部署和运行。在开发和修改代码时，请确保：

1. **环境兼容性**：所有功能必须基于客户端技术实现，避免使用服务器端处理
2. **数据存储策略**：优先使用 GitHub API 进行数据存储和同步，本地存储（localStorage）作为缓存和备用方案
3. **路径处理**：使用相对路径，考虑 GitHub Pages 的 URL 结构
4. **API 调用**：确保跨域请求和 GitHub API 调用在静态环境下的兼容性
5. **测试验证**：在类似 GitHub Pages 的静态服务器环境中测试功能

所有代码修改都应考虑 GitHub Pages 的网络环境特性，确保功能在实际部署后能正常工作。

第二条：环境兼容性和逻辑分离原则

在开发和修改代码时，必须确保系统能够正确识别并适配不同的运行环境，具体要求如下：

**环境识别要求：**
- 系统必须能够自动检测当前运行环境（本地开发环境 vs GitHub Pages 网络环境）
- 使用环境管理器（如 `window.environmentManager` 或 `window.dataManager.shouldUseGitHubStorage()`）来判断存储策略

**数据存储策略：**
- 本地开发环境：优先使用 localStorage，Firebase 作为备用
- GitHub Pages 网络环境：优先使用 GitHub API 存储，localStorage 作为缓存
- 避免硬编码环境假设，所有环境判断必须通过动态检测

**功能实现原则：**
- 每个功能模块都必须包含环境适配逻辑
- 数据读取：先检查主要存储源，失败时回退到备用存储
- 数据写入：根据环境选择合适的存储目标，确保数据同步
- 错误处理：当主要存储失败时，提供清晰的降级方案

**测试验证要求：**
- 在本地开发环境测试所有功能的基本逻辑
- 在模拟的 GitHub Pages 环境测试网络存储功能
- 确保环境切换时功能不会出现逻辑错误或数据丢失
- 验证离线/在线状态切换时的数据一致性

**禁止的做法：**
- 不得假设特定环境总是可用（如 Firebase 连接）
- 不得在代码中硬编码环境特定的逻辑路径
- 不得忽略环境检测，直接使用某种存储方式
- 不得在不同环境间产生数据格式或接口不兼容问题